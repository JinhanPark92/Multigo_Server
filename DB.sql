SET TERMOUT OFF
SET ECHO OFF

DROP USER MULTIGO CASCADE;
CREATE USER MULTIGO IDENTIFIED BY MULTI
DEFAULT TABLESPACE MC;

GRANT CONNECT, RESOURCE, DBA TO MULTIGO;

CONN MULTIGO/MULTI;

DROP TABLE LISTS_AND_ITEMS;
DROP TABLE LISTS;
-- DROP TABLE USERS;
-- DROP TABLE ACCOUNTS;
-- CREATE TABLE ACCOUNTS(
--     ACCOUNT_ID VARCHAR2(20) CONSTRAINT PK_ACCOUNTS PRIMARY KEY,
--     BALANCE NUMBER(10)
-- );

-- INSERT INTO ACCOUNTS VALUES('1111-1111-1111-1111', 120000);
-- INSERT INTO ACCOUNTS VALUES('1111-1111-1111-2222', 30000);
-- INSERT INTO ACCOUNTS VALUES('1111-1111-1111-3333', 100000);
-- INSERT INTO ACCOUNTS VALUES('1111-1111-1111-4444', 90000);
-- INSERT INTO ACCOUNTS VALUES('1111-1111-1111-5555', 200000);
-- INSERT INTO ACCOUNTS VALUES('1111-1111-1111-6666', 300000);

-- CREATE TABLE USERS(
--     USER_ID VARCHAR2(40) CONSTRAINT PK_USERS PRIMARY KEY,
--     PASSWORD VARCHAR2(20) NOT NULL,
--     NAME VARCHAR2(30),
--     ACCOUNT_ID VARCHAR2(20) CONSTRAINT FK_ACCOUNTS_USERS REFERENCES ACCOUNTS
-- );

-- INSERT INTO USERS VALUES('USER001', '001', '최환', '1111-1111-1111-1111');
-- INSERT INTO USERS VALUES('USER002', '002', '김하균', '1111-1111-1111-2222');
-- INSERT INTO USERS VALUES('USER003', '003', '박진한', '1111-1111-1111-3333');
-- INSERT INTO USERS VALUES('USER004', '004', '조규창', '1111-1111-1111-4444');
-- INSERT INTO USERS VALUES('USER005', '005', '최영신', '1111-1111-1111-5555');
-- INSERT INTO USERS VALUES('USER006', '006', '이윤호', '1111-1111-1111-6666');

DROP SEQUENCE LIST_SEQUENCE;
CREATE SEQUENCE LIST_SEQUENCE;

CREATE TABLE LISTS(
    LIST_ID NUMBER(6) CONSTRAINT PK_LISTS PRIMARY KEY,
    PURCHASE_DATE DATE DEFAULT SYSDATE,
    TOTAL NUMBER(6),
    USER_ID VARCHAR2(40)
);

INSERT INTO LISTS VALUES(LIST_SEQUENCE.NEXTVAL, TO_DATE('01-01-2020','dd-mm-yyyy'), 10000, 'USER001');
INSERT INTO LISTS VALUES(LIST_SEQUENCE.NEXTVAL, TO_DATE('03-02-2020','dd-mm-yyyy'), 74000, 'USER002');
INSERT INTO LISTS VALUES(LIST_SEQUENCE.NEXTVAL, TO_DATE('05-03-2020','dd-mm-yyyy'), 3000, 'USER003');
INSERT INTO LISTS VALUES(LIST_SEQUENCE.NEXTVAL, TO_DATE('07-04-2020','dd-mm-yyyy'), 53000, 'USER004');
INSERT INTO LISTS VALUES(LIST_SEQUENCE.NEXTVAL, TO_DATE('09-05-2020','dd-mm-yyyy'), 28000, 'USER005');
INSERT INTO LISTS VALUES(LIST_SEQUENCE.NEXTVAL, TO_DATE('11-06-2020','dd-mm-yyyy'), 123000, 'USER006');
INSERT INTO LISTS VALUES(LIST_SEQUENCE.NEXTVAL, TO_DATE('13-07-2020','dd-mm-yyyy'), 37000, 'USER001');

DROP TABLE MARKETS;
DROP TABLE ITEMS;
CREATE TABLE ITEMS(
    ITEM_ID VARCHAR2(30) CONSTRAINT PK_ITEMS PRIMARY KEY,
    NAME VARCHAR2(30),
    PRICE NUMBER(10)
);

INSERT INTO ITEMS VALUES('ITEM001', 'ITEM NO1', 3000);
INSERT INTO ITEMS VALUES('ITEM002', 'ITEM NO2', 7000);
INSERT INTO ITEMS VALUES('ITEM003', 'ITEM NO3', 1000);
INSERT INTO ITEMS VALUES('ITEM004', 'ITEM NO4', 10000);
INSERT INTO ITEMS VALUES('ITEM005', 'ITEM NO5', 4000);

CREATE TABLE LISTS_AND_ITEMS(
    LIST_ID NUMBER(6) CONSTRAINT FK_LISTS_CHILD REFERENCES LISTS(LIST_ID),
    ITEM_ID VARCHAR2(30) CONSTRAINT FK_ITEMS_CHILD REFERENCES ITEMS(ITEM_ID),
    CNT NUMBER(3)
);

INSERT INTO LISTS_AND_ITEMS VALUES(1, 'ITEM004', 1);
INSERT INTO LISTS_AND_ITEMS VALUES(2, 'ITEM004', 7);
INSERT INTO LISTS_AND_ITEMS VALUES(2, 'ITEM005', 1);
INSERT INTO LISTS_AND_ITEMS VALUES(3, 'ITEM003', 3);
INSERT INTO LISTS_AND_ITEMS VALUES(4, 'ITEM001', 1);
INSERT INTO LISTS_AND_ITEMS VALUES(4, 'ITEM004', 3);
INSERT INTO LISTS_AND_ITEMS VALUES(4, 'ITEM005', 5);
INSERT INTO LISTS_AND_ITEMS VALUES(5, 'ITEM002', 2);
INSERT INTO LISTS_AND_ITEMS VALUES(5, 'ITEM004', 1);
INSERT INTO LISTS_AND_ITEMS VALUES(5, 'ITEM005', 1);
INSERT INTO LISTS_AND_ITEMS VALUES(6, 'ITEM001', 1);
INSERT INTO LISTS_AND_ITEMS VALUES(6, 'ITEM004', 10);
INSERT INTO LISTS_AND_ITEMS VALUES(6, 'ITEM005', 5);
INSERT INTO LISTS_AND_ITEMS VALUES(7, 'ITEM003', 1);
INSERT INTO LISTS_AND_ITEMS VALUES(7, 'ITEM004', 2);
INSERT INTO LISTS_AND_ITEMS VALUES(7, 'ITEM005', 4);

CREATE TABLE MARKETS(
    MARKET_ID NUMBER(6),
    ITEM_ID VARCHAR2(30) CONSTRAINT FK_ITEMS_MARKETS REFERENCES ITEMS,
    STOCK NUMBER(4),
    CONSTRAINT PK_MARKETS PRIMARY KEY(MARKET_ID, ITEM_ID)
);

INSERT INTO MARKETS VALUES(1, 'ITEM001', 100);
INSERT INTO MARKETS VALUES(1, 'ITEM002', 100);
INSERT INTO MARKETS VALUES(1, 'ITEM003', 100);
INSERT INTO MARKETS VALUES(1, 'ITEM004', 100);
INSERT INTO MARKETS VALUES(1, 'ITEM005', 100);
INSERT INTO MARKETS VALUES(2, 'ITEM001', 100);
INSERT INTO MARKETS VALUES(2, 'ITEM002', 100);
INSERT INTO MARKETS VALUES(2, 'ITEM003', 100);
INSERT INTO MARKETS VALUES(2, 'ITEM004', 100);
INSERT INTO MARKETS VALUES(2, 'ITEM005', 100);

SET TERMOUT ON
SET ECHO ON